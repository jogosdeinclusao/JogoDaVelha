<html><head><base href="." /><title>Jogo da Velha</title><style>
:root {
  --primary-color: #2196F3;
  --secondary-color: #FF4081;
  --background-color: #f0f2f5;
  --text-color: #333;
  --cell-bg: #ffffff;
  --cell-hover: #e0e0e0;
}

[data-theme="dark"] {
  --primary-color: #64B5F6;
  --secondary-color: #FF80AB;
  --background-color: #1a1a1a;
  --text-color: #ffffff;
  --cell-bg: #2d2d2d;
  --cell-hover: #3d3d3d;
}

body {
  font-family: 'Roboto', sans-serif;
  background-color: var(--background-color);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  padding: 20px;
  color: var(--text-color);
  transition: all 0.3s ease;
}

h1 {
  color: var(--text-color);
  text-align: center;
  margin-bottom: 30px;
  font-size: 2.5em;
}

.board {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  background: var(--cell-bg);
  padding: 15px;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.cell {
  width: 100px;
  height: 100px;
  background: var(--background-color);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5em;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
}

.cell:hover {
  background: var(--cell-hover);
}

.status {
  margin: 20px 0;
  font-size: 1.5em;
  color: var(--text-color);
}

.restart, .theme-toggle {
  background: var(--primary-color);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 25px;
  font-size: 1.1em;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 10px;
}

.restart:hover, .theme-toggle:hover {
  transform: scale(1.05);
}

.x {
  color: var(--primary-color);
}

.o {
  color: var(--secondary-color);
}

@keyframes winner {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.winner {
  animation: winner 0.5s ease-in-out;
  background: #e3f2fd !important;
}

.controls {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.game-mode {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 20px;
}

.mode-button {
  background: var(--primary-color);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 25px;
  font-size: 1.1em;
  cursor: pointer;
  transition: all 0.3s ease;
}

.mode-button:hover {
  transform: scale(1.05);
}

.mode-button.selected {
  background: var(--secondary-color);
}

.board.hidden {
  display: none;
}

.footer {
  margin-top: 40px;
  text-align: center;
  color: var(--text-color);
}

.footer a {
  color: var(--primary-color);
  text-decoration: none;
  transition: color 0.3s ease;
}

.footer a:hover {
  color: var(--secondary-color);
}
</style></head><body>
<h1>Jogo da Velha</h1>
<div class="game-mode">
  <button class="mode-button" id="friendMode">Jogar com Amigo</button>
  <button class="mode-button" id="aiMode">Jogar contra IA</button>
</div>
<div class="status" id="status">Selecione um modo de jogo</div>
<div class="board hidden" id="board">
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
  <div class="cell" data-cell></div>
</div>
<div class="controls">
  <button class="restart" id="restartButton">Recomeçar Jogo</button>
  <button class="theme-toggle" id="themeToggle">Alternar Tema</button>
</div>
<div class="footer">
  <p>Jogo criado por Pedro Enrique</p>
  <p><a href="https://jogosdeinclusao.github.io/">Acesse Jogos de Inclusão</a></p>
</div>

<script>
const X_CLASS = 'x';
const O_CLASS = 'o';
const WINNING_COMBINATIONS = [
  [0, 1, 2],
  [3, 4, 5],
  [6, 7, 8],
  [0, 3, 6],
  [1, 4, 7],
  [2, 5, 8],
  [0, 4, 8],
  [2, 4, 6]
];

const cellElements = document.querySelectorAll('[data-cell]');
const board = document.getElementById('board');
const statusText = document.getElementById('status');
const restartButton = document.getElementById('restartButton');
const themeToggle = document.getElementById('themeToggle');
let xTurn = true;
let gameMode = null;
const friendModeBtn = document.getElementById('friendMode');
const aiModeBtn = document.getElementById('aiMode');

friendModeBtn.addEventListener('click', () => startGameMode('friend'));
aiModeBtn.addEventListener('click', () => startGameMode('ai'));

function setTheme(theme) {
  document.documentElement.setAttribute('data-theme', theme);
  localStorage.setItem('theme', theme);
}

function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute('data-theme');
  const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
  setTheme(newTheme);
}

// Load saved theme
const savedTheme = localStorage.getItem('theme') || 'light';
setTheme(savedTheme);

themeToggle.addEventListener('click', toggleTheme);

function startGameMode(mode) {
  gameMode = mode;
  board.classList.remove('hidden');
  friendModeBtn.classList.toggle('selected', mode === 'friend');
  aiModeBtn.classList.toggle('selected', mode === 'ai');
  startGame();
}

restartButton.addEventListener('click', startGame);

function startGame() {
  xTurn = true;
  cellElements.forEach(cell => {
    cell.classList.remove(X_CLASS);
    cell.classList.remove(O_CLASS);
    cell.classList.remove('winner');
    cell.removeEventListener('click', handleClick);
    cell.addEventListener('click', handleClick, { once: true });
    cell.textContent = '';
  });
  setStatusMessage();
}

function handleClick(e) {
  const cell = e.target;
  if (cell.classList.contains(X_CLASS) || cell.classList.contains(O_CLASS)) return;

  placeMark(cell, xTurn ? X_CLASS : O_CLASS);

  if (checkWin(xTurn ? X_CLASS : O_CLASS)) {
    endGame(false);
  } else if (isDraw()) {
    endGame(true);
  } else {
    swapTurns();
    setStatusMessage();

    if (gameMode === 'ai' && !xTurn) {
      setTimeout(makeAiMove, 500);
    }
  }
}

function makeAiMove() {
  const emptyCells = [...cellElements].filter(cell => 
    !cell.classList.contains(X_CLASS) && !cell.classList.contains(O_CLASS)
  );

  if (emptyCells.length > 0) {
    let bestMove = findBestMove();
    cellElements[bestMove].click();
  }
}

function findBestMove() {
  let bestScore = -Infinity;
  let bestMove = 0;

  for (let i = 0; i < cellElements.length; i++) {
    if (!cellElements[i].classList.contains(X_CLASS) && !cellElements[i].classList.contains(O_CLASS)) {
      cellElements[i].classList.add(O_CLASS);
      let score = minimax(0, false);
      cellElements[i].classList.remove(O_CLASS);
      
      if (score > bestScore) {
        bestScore = score;
        bestMove = i;
      }
    }
  }

  return bestMove;
}

function minimax(depth, isMaximizing) {
  if (checkWin(O_CLASS)) return 1;
  if (checkWin(X_CLASS)) return -1;
  if (isDraw()) return 0;

  if (isMaximizing) {
    let bestScore = -Infinity;
    for (let i = 0; i < cellElements.length; i++) {
      if (!cellElements[i].classList.contains(X_CLASS) && !cellElements[i].classList.contains(O_CLASS)) {
        cellElements[i].classList.add(O_CLASS);
        let score = minimax(depth + 1, false);
        cellElements[i].classList.remove(O_CLASS);
        bestScore = Math.max(score, bestScore);
      }
    }
    return bestScore;
  } else {
    let bestScore = Infinity;
    for (let i = 0; i < cellElements.length; i++) {
      if (!cellElements[i].classList.contains(X_CLASS) && !cellElements[i].classList.contains(O_CLASS)) {
        cellElements[i].classList.add(X_CLASS);
        let score = minimax(depth + 1, true);
        cellElements[i].classList.remove(X_CLASS);
        bestScore = Math.min(score, bestScore);
      }
    }
    return bestScore;
  }
}

function placeMark(cell, currentClass) {
  cell.classList.add(currentClass);
  cell.textContent = currentClass.toUpperCase();
}

function swapTurns() {
  xTurn = !xTurn;
}

function setStatusMessage() {
  if (!gameMode) {
    statusText.textContent = 'Selecione um modo de jogo';
  } else {
    statusText.textContent = xTurn ? 'Vez do Jogador X' : (gameMode === 'ai' ? 'Vez da IA' : 'Vez do Jogador O');
  }
}

function checkWin(currentClass) {
  return WINNING_COMBINATIONS.some(combination => {
    const win = combination.every(index => {
      return cellElements[index].classList.contains(currentClass);
    });
    if (win) {
      combination.forEach(index => {
        cellElements[index].classList.add('winner');
      });
    }
    return win;
  });
}

function isDraw() {
  return [...cellElements].every(cell => {
    return cell.classList.contains(X_CLASS) || cell.classList.contains(O_CLASS);
  });
}

function endGame(draw) {
  if (draw) {
    statusText.textContent = 'Empate!';
  } else {
    statusText.textContent = `${xTurn ? 'X' : (gameMode === 'ai' ? 'IA' : 'O')} Venceu!`;
  }
  cellElements.forEach(cell => {
    cell.removeEventListener('click', handleClick);
  });
}
</script>
</body></html>